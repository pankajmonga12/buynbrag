var rte_tag="-rte-tmp-tag-";var rte_toolbar={s1:{separator:true},bold:{command:"bold",tags:["b","strong"]},italic:{command:"italic",tags:["i","em"]},strikeThrough:{command:"strikethrough",tags:["s","strike"]},underline:{command:"underline",tags:["u"]},s2:{separator:true},justifyLeft:{command:"justifyleft"},justifyCenter:{command:"justifycenter"},justifyRight:{command:"justifyright"},justifyFull:{command:"justifyfull"},s3:{separator:true},indent:{command:"indent"},outdent:{command:"outdent"},s4:{separator:true},subscript:{command:"subscript",tags:["sub"]},superscript:{command:"superscript",tags:["sup"]},s5:{separator:true},orderedList:{command:"insertorderedlist",tags:["ol"]},unorderedList:{command:"insertunorderedlist",tags:["ul"]},s6:{separator:true},block:{command:"formatblock",select:'<select>	<option value="">- format -</option>	<option value="<p>">Paragraph</option>	<option value="<h1>">Header 1</option>	<option value="<h2>">Header 2</options>	<option value="<h3>">Header 3</option>	<option value="<h4>">Header 4</options>	<option value="<h5>">Header 5</option>	<option value="<h6>">Header 6</options></select>	',tag_cmp:lwrte_block_compare,tags:["p","h1","h2","h3","h4","h5","h6"]},font:{command:"fontname",select:'<select>	<option value="">- font -</option>	<option value="arial">Arial</option>	<option value="comic sans ms">Comic Sans</option>	<option value="courier new">Courier New</options>	<option value="georgia">Georgia</option>	<option value="helvetica">Helvetica</options>	<option value="impact">Impact</option>	<option value="times new roman">Times</options>	<option value="trebuchet ms">Trebuchet</options>	<option value="verdana">Verdana</options></select>	',tags:["font"]},size:{command:"fontsize",select:'<select>	<option value="">-</option>	<option value="1">1 (8pt)</option>	<option value="2">2 (10pt)</option>	<option value="3">3 (12pt)</options>	<option value="4">4 (14pt)</option>	<option value="5">5 (16pt)</options>	<option value="6">6 (18pt)</option>	<option value="7">7 (20pt)</options></select>	',tags:["font"]},style:{exec:lwrte_style,init:lwrte_style_init},color:{exec:lwrte_color},image:{exec:lwrte_image,tags:["img"]},link:{exec:lwrte_link,tags:["a"]},unlink:{command:"unlink"},s8:{separator:true},removeFormat:{exec:lwrte_unformat},word:{exec:lwrte_cleanup_word},clear:{exec:lwrte_clear}};var html_toolbar={s1:{separator:true},word:{exec:lwrte_cleanup_word},clear:{exec:lwrte_clear}};function lwrte_block_compare(c,d){d=d.replace(/<([^>]*)>/,"$1");return(d.toLowerCase()==c.nodeName.toLowerCase())}function lwrte_style_init(c){var d=this;d.select='<select><option value="">- no css -</option></select>';if(c.css.length){$.ajax({url:"styles.php",type:"POST",data:{css:c.css[c.css.length-1]},async:false,success:function(a){var b=a.split(",");var h="";for(var g in b){h+='<option value="'+b[g]+'">'+b[g]+"</option>"}d.select='<select><option value="">- css -</option>'+h+"</select>"}})}}function lwrte_style(e){if(e){try{var i=e.options[e.selectedIndex].value;var g=this;var j=g.get_selected_text();j='<span class="'+i+'">'+j+"</span>";g.selection_replace_with(j);e.selectedIndex=0}catch(h){}}}function lwrte_color(){var i=this;var D=i.create_panel("Set color for text",385);var r=false;var v=false;D.append('<div class="colorpicker1"><div class="rgb" id="rgb"></div></div><div class="colorpicker1"><div class="gray" id="gray"></div></div><div class="colorpicker2">	<div class="palette" id="palette"></div>	<div class="preview" id="preview"></div>	<div class="color" id="color"></div></div><div class="clear"></div><p class="submit"><button id="ok">Ok</button><button id="cancel">Cancel</button></p>').show();var t=$("#preview",D);var y=$("#color",D);var A=$("#palette",D);var C=["#660000","#990000","#cc0000","#ff0000","#333333","#006600","#009900","#00cc00","#00ff00","#666666","#000066","#000099","#0000cc","#0000ff","#999999","#909000","#900090","#009090","#ffffff","#cccccc","#ffff00","#ff00ff","#00ffff","#000000","#eeeeee"];for(var w=0;w<C.length;w++){$("<div></div>").addClass("item").css("background",C[w]).appendTo(A)}var q=$("#rgb").height();var u=$("#rgb").width()/6;$("#rgb,#gray,#palette",D).mousedown(function(a){r=true;return false}).mouseup(function(a){r=false;return false}).mouseout(function(a){v=false;return false}).mouseover(function(a){v=true;return false});$("#rgb").mousemove(function(a){if(r&&v){s(this,true,false,false,a)}return false});$("#gray").mousemove(function(a){if(r&&v){s(this,false,true,false,a)}return false});$("#palette").mousemove(function(a){if(r&&v){s(this,false,false,true,a)}return false});$("#rgb").click(function(a){s(this,true,false,false,a);return false});$("#gray").click(function(a){s(this,false,true,false,a);return false});$("#palette").click(function(a){s(this,false,false,true,a);return false});$("#cancel",D).click(function(){D.remove();return false});$("#ok",D).click(function(){var a=y.html();if(a.length>0&&a.charAt(0)=="#"){if(i.iframe_doc.selection){i.range.select()}i.editor_cmd("foreColor",a)}D.remove();return false});function x(b){var a="0123456789abcdef";return a.charAt(Math.floor(b/16))+a.charAt(b%16)}function z(c){var b={x:c.offsetLeft,y:c.offsetTop};if(c.offsetParent){var a=z(c.offsetParent);b.x+=a.x;b.y+=a.y}return b}function B(d,e){var c,a;e=e||window.event;var f=e.target||e.srcElement;var b=z(d);c=e.pageX-b.x;a=e.pageY-b.y;return{x:c,y:a}}function s(k,c,m,n,g){var f,j,b,e;var h=B(k,g);var a=h.x;var d=h.y;if(c){f=(a>=0)*(a<u)*255+(a>=u)*(a<2*u)*(2*255-a*255/u)+(a>=4*u)*(a<5*u)*(-4*255+a*255/u)+(a>=5*u)*(a<6*u)*255;j=(a>=0)*(a<u)*(a*255/u)+(a>=u)*(a<3*u)*255+(a>=3*u)*(a<4*u)*(4*255-a*255/u);b=(a>=2*u)*(a<3*u)*(-2*255+a*255/u)+(a>=3*u)*(a<5*u)*255+(a>=5*u)*(a<6*u)*(6*255-a*255/u);var l=(q-d)/q;f=128+(f-128)*l;j=128+(j-128)*l;b=128+(b-128)*l}else{if(m){f=j=b=(q-d)*1.7}else{if(n){a=Math.floor(a/10);d=Math.floor(d/10);e=C[a+d*5]}}}if(!n){e="#"+x(f)+x(j)+x(b)}t.css("background",e);y.html(e)}}function lwrte_image(){var self=this;var panel=self.create_panel("Insert image",385);panel.append('<p><label>URL</label><input type="text" id="url" size="30" value=""><button id="file">Upload</button><button id="view">View</button></p><div class="clear"></div><p class="submit"><button id="ok">Ok</button><button id="cancel">Cancel</button></p>').show();var url=$("#url",panel);var upload=$("#file",panel).upload({autoSubmit:false,action:"uploader.php",onSelect:function(){var file=this.filename();var ext=(/[.]/.exec(file))?/[^.]+$/.exec(file.toLowerCase()):"";if(!(ext&&/^(jpg|png|jpeg|gif)$/.test(ext))){alert("Invalid file extension");return}this.submit()},onComplete:function(response){if(response.length<=0){return}response=eval("("+response+")");if(response.error&&response.error.length>0){alert(response.error)}else{url.val((response.file&&response.file.length>0)?response.file:"")}}});$("#view",panel).click(function(){(url.val().length>0)?window.open(url.val()):alert("Enter URL of image to view");return false});$("#cancel",panel).click(function(){panel.remove();return false});$("#ok",panel).click(function(){var file=url.val();self.editor_cmd("insertImage",file);panel.remove();return false})}function lwrte_unformat(){this.editor_cmd("removeFormat");this.editor_cmd("unlink")}function lwrte_clear(){if(confirm("Clear Document?")){this.set_content("")}}function lwrte_cleanup_word(){this.set_content(b(this.get_content(),true,true,true));function b(i,a,h,g){i=i.replace(/<o:p>\s*<\/o:p>/g,"");i=i.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;");i=i.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"");i=i.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"");i=i.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,'"');i=i.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"");i=i.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"');i=i.replace(/\s*TEXT-ALIGN: [^\s;]+;?"/gi,'"');i=i.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,'"');i=i.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"');i=i.replace(/\s*tab-stops:[^;"]*;?/gi,"");i=i.replace(/\s*tab-stops:[^"]*/gi,"");if(a){i=i.replace(/\s*face="[^"]*"/gi,"");i=i.replace(/\s*face=[^ >]*/gi,"");i=i.replace(/\s*FONT-FAMILY:[^;"]*;?/gi,"")}i=i.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3");if(h){i=i.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gi,"<$1$3")}i=i.replace(/<STYLE[^>]*>[\s\S]*?<\/STYLE[^>]*>/gi,"");i=i.replace(/<(?:META|LINK)[^>]*>\s*/gi,"");i=i.replace(/\s*style="\s*"/gi,"");i=i.replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,"&nbsp;");i=i.replace(/<SPAN\s*[^>]*><\/SPAN>/gi,"");i=i.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");i=i.replace(/<SPAN\s*>([\s\S]*?)<\/SPAN>/gi,"$1");i=i.replace(/<FONT\s*>([\s\S]*?)<\/FONT>/gi,"$1");i=i.replace(/<\\?\?xml[^>]*>/gi,"");i=i.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"");i=i.replace(/<\/?\w+:[^>]*>/gi,"");i=i.replace(/<\!--[\s\S]*?-->/g,"");i=i.replace(/<(U|I|STRIKE)>&nbsp;<\/\1>/g,"&nbsp;");i=i.replace(/<H\d>\s*<\/H\d>/gi,"");i=i.replace(/<(\w+)[^>]*\sstyle="[^"]*DISPLAY\s?:\s?none[\s\S]*?<\/\1>/ig,"");i=i.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3");i=i.replace(/<(\w[^>]*) onmouseover="([^\"]*)"([^>]*)/gi,"<$1$3");i=i.replace(/<(\w[^>]*) onmouseout="([^\"]*)"([^>]*)/gi,"<$1$3");if(g){i=i.replace(/<H(\d)([^>]*)>/gi,"<h$1>");i=i.replace(/<(H\d)><FONT[^>]*>([\s\S]*?)<\/FONT><\/\1>/gi,"<$1>$2</$1>");i=i.replace(/<(H\d)><EM>([\s\S]*?)<\/EM><\/\1>/gi,"<$1>$2</$1>")}else{i=i.replace(/<H1([^>]*)>/gi,'<div$1><b><font size="6">');i=i.replace(/<H2([^>]*)>/gi,'<div$1><b><font size="5">');i=i.replace(/<H3([^>]*)>/gi,'<div$1><b><font size="4">');i=i.replace(/<H4([^>]*)>/gi,'<div$1><b><font size="3">');i=i.replace(/<H5([^>]*)>/gi,'<div$1><b><font size="2">');i=i.replace(/<H6([^>]*)>/gi,'<div$1><b><font size="1">');i=i.replace(/<\/H\d>/gi,"</font></b></div>");var j=new RegExp("(<P)([^>]*>[\\s\\S]*?)(</P>)","gi");i=i.replace(j,"<div$2</div>");i=i.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"");i=i.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"");i=i.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")}return i}}function lwrte_link(){var self=this;var panel=self.create_panel("Create link / Attach file",385);panel.append('<p><label>URL</label><input type="text" id="url" size="30" value=""><button id="file">Attach File</button><button id="view">View</button></p><div class="clear"></div><p><label>Title</label><input type="text" id="title" size="30" value=""><label>Target</label><select id="target"><option value="">default</option><option value="_blank">new</option></select></p><div class="clear"></div><p class="submit"><button id="ok">Ok</button><button id="cancel">Cancel</button></p>').show();$("#cancel",panel).click(function(){panel.remove();return false});var url=$("#url",panel);var upload=$("#file",panel).upload({autoSubmit:true,action:"uploader.php",onComplete:function(response){if(response.length<=0){return}response=eval("("+response+")");if(response.error&&response.error.length>0){alert(response.error)}else{url.val((response.file&&response.file.length>0)?response.file:"")}}});$("#view",panel).click(function(){(url.val().length>0)?window.open(url.val()):alert("Enter URL to view");return false});$("#ok",panel).click(function(){var url=$("#url",panel).val();var target=$("#target",panel).val();var title=$("#title",panel).val();if(self.get_selected_text().length<=0){alert("Select the text you wish to link!");return false}panel.remove();if(url.length<=0){return false}self.editor_cmd("unlink");self.editor_cmd("createLink",rte_tag);var tmp=$("<span></span>").append(self.get_selected_html());if(target.length>0){$('a[href*="'+rte_tag+'"]',tmp).attr("target",target)}if(title.length>0){$('a[href*="'+rte_tag+'"]',tmp).attr("title",title)}$('a[href*="'+rte_tag+'"]',tmp).attr("href",url);self.selection_replace_with(tmp.html());return false})};