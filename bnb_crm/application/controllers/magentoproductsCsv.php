<?php

    class MagentoproductsCsv extends CI_Controller {

  public function __construct()
  {
    parent::__construct();
    $this->load->model('magento_products_model', 'magento_products');
    //$this->load->helper('download');
    $this->load->helper('file'); 
    $this->load->helper('array');
    $this->load->dbutil();
  }

    function trim_function($string)
    {
     $string = substr($string,0,100);
     $string = substr($string,0,strrpos($string," "));
     return $string;
    }

    function file_exists_check($url) {
    $headers = get_headers($url);
    return substr($headers[0], 9, 3);
     }

  public function prodCSV() 
  {
    //$file = fopen('php://output', 'w');
    $file = tmpfile();
    //$filePath = sys_get_temp_dir();

    $filePath = stream_get_meta_data ( $file );
    $filePath = $filePath['uri'];

    echo "filePath = ".$filePath;

    $product = $this->magento_products->csvprodData();

    log_message('INFO', "magento:::read from DB");

    $productDetail = $product;

    $product = NULL;

    //echo "<pre>".print_r($productDetail,TRUE)."</pre>";

    //ob_start();
    $header  = array('sku' => 'sku',
                     '_store'=>'_store',
                     '_attribute_set'=>'_attribute_set',
                     '_type'=>'_type',
                     '_category'=>'_category',
                     '_root_category'=>'_root_category',
                     '_product_websites'=>'_product_websites',
                     'blacknwhite_prbrand'=>'blacknwhite_prbrand',
                     'blacknwhite_prbrandlink'=>'blacknwhite_prbrandlink',
                     'blacknwhite_prbrandpos'=>'blacknwhite_prbrandpos',
                     'blacknwhite_prbrandtarget'=>'blacknwhite_prbrandtarget',
                     'blacknwhite_prcolleteral'=>'blacknwhite_prcolleteral',
                     'blacknwhite_prcustom'=>'blacknwhite_prcustom',
                     'blacknwhite_prlayout'=>'blacknwhite_prlayout',
                     'blacknwhite_prmoreviews'=>'blacknwhite_prmoreviews',
                     'blacknwhite_productimg'=>'blacknwhite_productimg',
                     'blacknwhite_prrelated'=>'blacknwhite_prrelated',
                     'blacknwhite_prprevnext'=>'blacknwhite_prprevnext',
                     'blacknwhite_prrelatedcontent'=>'blacknwhite_prrelatedcontent',
                     'blacknwhite_prsidebar'=>'blacknwhite_prsidebar',
                     'blacknwhite_prsku'=>'blacknwhite_prsku',
                     'blacknwhite_prtabs'=>'blacknwhite_prtabs',
                     'blacknwhite_relatedpos'=>'blacknwhite_relatedpos',
                     'bnb_commission'=>'bnb_commission',
                     'color'=>'color',
                     'cost'=>'cost',
                     'country_of_manufacture'=>'country_of_manufacture',
                     'created_at'=>'created_at',
                     'custom_design'=>'custom_design',
                     'custom_design_from'=>'custom_design_from',
                     'custom_design_to'=>'custom_design_to',
                     'custom_layout_update'=>'custom_layout_update',
                     'description'=>'description',
                     'gallery'=>'gallery',
                     'gift_message_available'=>'gift_message_available',
                     'has_options'=>'has_options',
                     'image'=>'image',
                     'image_label'=>'image_label',
                     'manufacturer'=>'manufacturer',
                     'manufacturer_info'=>'manufacturer_info',
                     'media_gallery'=>'media_gallery',
                     'meta_description'=>'meta_description',
                     'meta_keyword'=>'meta_keyword',
                     'meta_title'=>'meta_title',
                     'minimal_price'=>'minimal_price',
                     'msrp'=>'msrp',
                     'msrp_display_actual_price_type'=>'msrp_display_actual_price_type',
                     'msrp_enabled'=>'msrp_enabled',
                     'name'=>'name',
                     'news_from_date'=>'news_from_date',
                     'news_to_date'=>'news_to_date',
                     'options_container'=>'options_container',
                     'page_layout'=>'page_layout',
                     'price'=>'price',
                     'required_options'=>'required_options',
                     'seller_name'=>'seller_name',
                     'shipping_cost'=>'shipping_cost',
                     'short_description'=>'short_description',
                     'small_image'=>'small_image',
                     'small_image_label'=>'small_image_label',
                     'special_from_date'=>'special_from_date',
                     'special_price'=>'special_price',
                     'special_to_date'=>'special_to_date',
                     'status'=>'status',
                     'tax_class_id'=>'tax_class_id',
                     'thumbnail'=>'thumbnail',
                     'thumbnail_label'=>'thumbnail_label',
                     'updated_at'=>'updated_at',
                     'url_key'=>'url_key',
                     'url_path'=>'url_path',
                     'visibility'=>'visibility',
                     'weight'=>'weight',
                     'qty'=>'qty',
                     'min_qty'=>'min_qty',
                     'use_config_min_qty'=>'use_config_min_qty',
                     'is_qty_decimal'=>'is_qty_decimal',
                     'backorders'=>'backorders',
                     'use_config_backorders'=>'use_config_backorders',
                     'min_sale_qty'=>'min_sale_qty',
                     'use_config_min_sale_qty'=>'use_config_min_sale_qty',
                     'max_sale_qty'=>'max_sale_qty',
                     'use_config_max_sale_qty'=>'use_config_max_sale_qty',
                     'is_in_stock'=>'is_in_stock',
                     'notify_stock_qty'=>'notify_stock_qty',
                     'use_config_notify_stock_qty'=>'use_config_notify_stock_qty',
                     'manage_stock'=>'manage_stock',
                     'use_config_manage_stock'=>'use_config_manage_stock',
                     'stock_status_changed_auto'=>'stock_status_changed_auto',
                     'use_config_qty_increments'=>'use_config_qty_increments',
                     'qty_increments'=>'qty_increments',
                     'use_config_enable_qty_inc'=>'use_config_enable_qty_inc',
                     'enable_qty_increments'=>'enable_qty_increments',
                     'is_decimal_divided'=>'is_decimal_divided',
                     '_links_related_sku'=>'_links_related_sku',
                     '_links_related_position'=>'_links_related_position',
                     '_links_crosssell_sku'=>'_links_crosssell_sku',
                     '_links_crosssell_position'=>'_links_crosssell_position',
                     '_links_upsell_sku'=>'_links_upsell_sku',
                     '_links_upsell_position'=>'_links_upsell_position',
                     '_associated_sku'=>'_associated_sku',
                     '_associated_default_qty'=>'_associated_default_qty',
                     '_associated_position'=>'_associated_position',
                     '_tier_price_website'=>'_tier_price_website',
                     '_tier_price_customer_group'=>'_tier_price_customer_group',
                     '_tier_price_qty'=>'_tier_price_qty',
                     '_tier_price_price'=>'_tier_price_price',
                     '_group_price_website'=>'_group_price_website',
                     '_group_price_customer_group'=>'_group_price_customer_group',
                     '_group_price_price'=>'_group_price_price',
                     '_media_attribute_id'=>'_media_attribute_id',
                     '_media_image'=>'_media_image',
                     '_media_lable'=>'_media_lable',
                     '_media_position'=>'_media_position',
                     '_media_is_disabled'=>'_media_is_disabled'
                     
                      );
    fputcsv($file, $header);
    $header = NULL; // free up memory
           $data= array();
           $dataCount = 0;
           //$final = array();
        foreach ($productDetail as $fields) 
        {  
            if ($fields[0]['productStatus']==1) 
            {
            
           $short_description = $this->trim_function($fields[0]['Description']);
           $storeURL = "http://buynbragstores.s3.amazonaws.com/assets/images/stores/";
           $image = $storeURL.$fields[0]['storeID']."/".$fields[0]['productID']."/fancy1.jpg";
           //$imagefile = file_get_contents($image);
           $rootcategory = $fields[0]['catName'].'/'.$fields[0]['sub_cat_name'].'/'.$fields[0]['sub_sub_cat_name'].'/'.$fields[0]['sub_sub_sub_cat_name'];
           $data[] = array('sku' =>'S'.$fields[0]['storeID'].'P'.$fields[0]['productID'],
                         '_store'=>'',
                         '_attribute_set'=>'Default',
                         '_type'=>'simple',
                         '_category'=>'CATEGORIES',
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'base',
                         'blacknwhite_prbrand'=>'Use Config Settings',
                         'blacknwhite_prbrandlink'=>'Use Config Settings',
                         'blacknwhite_prbrandpos'=>'Use Config Settings',
                         'blacknwhite_prbrandtarget'=>'Use Config Settings',
                         'blacknwhite_prcolleteral'=>'Use Config Settings',
                         'blacknwhite_prcustom'=>'Use Config Settings',
                         'blacknwhite_prlayout'=>'Use Config Settings',
                         'blacknwhite_prmoreviews'=>'Use Config Settings',
                         'blacknwhite_productimg'=>'Use Config Settings',
                         'blacknwhite_prrelated'=>'Use Config Settings',
                         'blacknwhite_prprevnext'=>'Use Config Settings',
                         'blacknwhite_prrelatedcontent'=>'Use Config Settings',
                         'blacknwhite_prsidebar'=>'Use Config Settings',
                         'blacknwhite_prsku'=>'Use Config Settings',
                         'blacknwhite_prtabs'=>'Use Config Settings',
                         'blacknwhite_relatedpos'=>'Use Config Settings',
                         'bnb_commission'=>$fields[0]['bnbComission'],
                         'color'=>'',
                         'cost'=>$fields[0]['sellerEarning'],
                         'country_of_manufacture'=>$fields[0]['Country'],
                         'created_at'=>$fields[0]['AddedOn'],
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>$fields[0]['Description'],
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'1',
                         'image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img1.jpg',
                         'image_label'=>'',
                         'manufacturer'=>$fields[0]['StoreName'],
                         'manufacturer_info'=>$fields[0]['aboutStore'],
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>$fields[0]['tags'],
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'Use config',
                         'msrp_enabled'=>'Use config',
                         'name'=>$fields[0]['productName'],
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'Block after Info Column',
                         'page_layout'=>'',
                         'price'=>$fields[0]['totalSellingPrice'],
                         'required_options'=>'0',
                         'seller_name'=>$fields[0]['StoreName'],
                         'shipping_cost'=>$fields[0]['shippingCost'],
                         'short_description'=>$short_description,
                         'small_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img1.jpg',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>$fields[0]['Discount'],
                         'special_to_date'=>'',
                         'status'=>$fields[0]['productStatus'],
                         'tax_class_id'=>'0',
                         'thumbnail'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img1.jpg',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'4',
                         'weight'=>$fields[0]['Weight'],
                         'qty'=>$fields[0]['productQuantity'],
                         'min_qty'=>'0',
                         'use_config_min_qty'=>'1',
                         'is_qty_decimal'=>'0',
                         'backorders'=>'0',
                         'use_config_backorders'=>'1',
                         'min_sale_qty'=>'1',
                         'use_config_min_sale_qty'=>'1',
                         'max_sale_qty'=>'0',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'1',
                         'notify_stock_qty'=>'1',
                         'use_config_notify_stock_qty'=>'1',
                         'manage_stock'=>'1',
                         'use_config_manage_stock'=>'1',
                         'stock_status_changed_auto'=>'1',
                         'use_config_qty_increments'=>'1',
                         'qty_increments'=>'0',
                         'use_config_enable_qty_inc'=>'1',
                         'enable_qty_increments'=>'0',
                         'is_decimal_divided'=>'0',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img1.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'1',
                         '_media_is_disabled'=>''
                         
                          ); 
$dataCount++;
 $image1 = $storeURL.$fields[0]['storeID']."/".$fields[0]['productID']."/img2_product.jpg";
                   // $imagefile1 = file_get_contents($image1);
                    if (!empty( $fields[0]['catName']) && $this->file_exists_check($image1) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img2.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'2',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   
                 }
                  else
                  {
                    if (!empty( $fields[0]['catName']))
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   
                 }
             }
                   $image3 = $storeURL.$fields[0]['storeID']."/".$fields[0]['productID']."/img3_product.jpg";
                   // $imagefile1 = file_get_contents($image1);
                    if (!empty( $fields[0]['sub_cat_name']) && $this->file_exists_check($image3) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img3.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'3',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   
                 }
                  else
                  {
                    if (!empty( $fields[0]['sub_cat_name']))
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   
                      }
                  }

                          $image4 = $storeURL.$fields[0]['storeID']."/".$fields[0]['productID']."/img4_product.jpg";
                   // $imagefile1 = file_get_contents($image1);
                    if (!empty( $fields[0]['sub_sub_cat_name']) && $this->file_exists_check($image4) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'].'/'.$fields[0]['sub_sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img4.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'4',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
  $image5 = $storeURL.$fields[0]['storeID']."/".$fields[0]['productID']."/img5_product.jpg";
 if (!empty( $fields[0]['sub_sub_sub_cat_name']) && $this->file_exists_check($image5) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'].'/'.$fields[0]['sub_sub_cat_name'].'/'.$fields[0]['sub_sub_sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img5.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'5',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
    if (!empty($fields[0]['storeCAT'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES',
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                 }
                 if (!empty($fields[0]['storeCAT'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['storeCAT'],
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   }
                   
                 }
                 elseif($this->file_exists_check($image5) != "404")
                 {
                    if (!empty( $fields[0]['storeCAT']) && $this->file_exists_check($image5) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES',
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img5.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'5',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                    }
                       if (!empty($fields[0]['storeCAT'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['storeCAT'],
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   }
                 }
             else{
                if (!empty( $fields[0]['sub_sub_sub_cat_name']) && $this->file_exists_check($image5) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'].'/'.$fields[0]['sub_sub_cat_name'].'/'.$fields[0]['sub_sub_sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img5.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'5',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
}
                if (!empty( $fields[0]['storeCAT']))
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES',
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                    }
                       if (!empty($fields[0]['storeCAT'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['storeCAT'],
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   }
             }
                   
                 }
                 elseif ( $this->file_exists_check($image4) != "404" ) 
                 {
                      if (!empty( $fields[0]['storeCAT']) && $this->file_exists_check($image4) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES',
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img4.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'4',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                       }
                       $image6 = $storeURL.$fields[0]['storeID']."/".$fields[0]['productID']."/img5_product.jpg";
                          if (!empty( $fields[0]['storeCAT']) && $this->file_exists_check($image6) != "404")
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['storeCAT'],
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'import/s'.$fields[0]['storeID'].'p'.$fields[0]['productID'].'img5.jpg',
                         '_media_lable'=>'',
                         '_media_position'=>'5',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                       }
                    else{
                        $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['storeCAT'],
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                    }
                    
                 }
                  else
                  {
                    if (!empty( $fields[0]['sub_sub_cat_name']))
                     {
                    $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'].'/'.$fields[0]['sub_sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                   
                      }
                            if (!empty($fields[0]['sub_sub_sub_cat_name'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['catName'].'/'.$fields[0]['sub_cat_name'].'/'.$fields[0]['sub_sub_cat_name'].'/'.$fields[0]['sub_sub_sub_cat_name'],
                         '_root_category'=>'Default Category',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                 }
    if (!empty($fields[0]['storeCAT'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES',
                         '_root_category'=>strtoupper($fields[0]['StoreName']).' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                 }
                 if (!empty($fields[0]['storeCAT'])) {
           $data[] = array('sku' => '',
                         '_store'=>'',
                         '_attribute_set'=>'',
                         '_type'=>'',
                         '_category'=>'CATEGORIES/'.$fields[0]['storeCAT'],
                         '_root_category'=>$fields[0]['StoreName'].' root',
                         '_product_websites'=>'',
                         'blacknwhite_prbrand'=>'',
                         'blacknwhite_prbrandlink'=>'',
                         'blacknwhite_prbrandpos'=>'',
                         'blacknwhite_prbrandtarget'=>'',
                         'blacknwhite_prcolleteral'=>'',
                         'blacknwhite_prcustom'=>'',
                         'blacknwhite_prlayout'=>'',
                         'blacknwhite_prmoreviews'=>'',
                         'blacknwhite_productimg'=>'',
                         'blacknwhite_prrelated'=>'',
                         'blacknwhite_prprevnext'=>'',
                         'blacknwhite_prrelatedcontent'=>'',
                         'blacknwhite_prsidebar'=>'',
                         'blacknwhite_prsku'=>'',
                         'blacknwhite_prtabs'=>'',
                         'blacknwhite_relatedpos'=>'',
                         'bnb_commission'=>'',
                         'color'=>'',
                         'cost'=>'',
                         'country_of_manufacture'=>'',
                         'created_at'=>'',
                         'custom_design'=>'',
                         'custom_design_from'=>'',
                         'custom_design_to'=>'',
                         'custom_layout_update'=>'',
                         'description'=>'',
                         'gallery'=>'',
                         'gift_message_available'=>'',
                         'has_options'=>'',
                         'image'=>'',
                         'image_label'=>'',
                         'manufacturer'=>'',
                         'manufacturer_info'=>'',
                         'media_gallery'=>'',
                         'meta_description'=>'',
                         'meta_keyword'=>'',
                         'meta_title'=>'',
                         'minimal_price'=>'',
                         'msrp'=>'',
                         'msrp_display_actual_price_type'=>'',
                         'msrp_enabled'=>'',
                         'name'=>'',
                         'news_from_date'=>'',
                         'news_to_date'=>'',
                         'options_container'=>'',
                         'page_layout'=>'',
                         'price'=>'',
                         'required_options'=>'',
                         'seller_name'=>'',
                         'shipping_cost'=>'',
                         'short_description'=>'',
                         'small_image'=>'',
                         'small_image_label'=>'',
                         'special_from_date'=>'',
                         'special_price'=>'',
                         'special_to_date'=>'',
                         'status'=>'',
                         'tax_class_id'=>'',
                         'thumbnail'=>'',
                         'thumbnail_label'=>'',
                         'updated_at'=>'',
                         'url_key'=>'',
                         'url_path'=>'',
                         'visibility'=>'',
                         'weight'=>'',
                         'qty'=>'',
                         'min_qty'=>'',
                         'use_config_min_qty'=>'',
                         'is_qty_decimal'=>'',
                         'backorders'=>'',
                         'use_config_backorders'=>'',
                         'min_sale_qty'=>'',
                         'use_config_min_sale_qty'=>'',
                         'max_sale_qty'=>'',
                         'use_config_max_sale_qty'=>'',
                         'is_in_stock'=>'',
                         'notify_stock_qty'=>'',
                         'use_config_notify_stock_qty'=>'',
                         'manage_stock'=>'',
                         'use_config_manage_stock'=>'',
                         'stock_status_changed_auto'=>'',
                         'use_config_qty_increments'=>'',
                         'qty_increments'=>'',
                         'use_config_enable_qty_inc'=>'',
                         'enable_qty_increments'=>'',
                         'is_decimal_divided'=>'',
                         '_links_related_sku'=>'',
                         '_links_related_position'=>'',
                         '_links_crosssell_sku'=>'',
                         '_links_crosssell_position'=>'',
                         '_links_upsell_sku'=>'',
                         '_links_upsell_position'=>'',
                         '_associated_sku'=>'',
                         '_associated_default_qty'=>'',
                         '_associated_position'=>'',
                         '_tier_price_website'=>'',
                         '_tier_price_customer_group'=>'',
                         '_tier_price_qty'=>'',
                         '_tier_price_price'=>'',
                         '_group_price_website'=>'',
                         '_group_price_customer_group'=>'',
                         '_group_price_price'=>'',
                         '_media_attribute_id'=>'',
                         '_media_image'=>'',
                         '_media_lable'=>'',
                         '_media_position'=>'',
                         '_media_is_disabled'=>''
                         
                          );
$dataCount++;
                 }
                  }
              }
          }
        //echo "<pre>".print_r($data,TRUE)."</pre>";
     // $final=print_r($data,TRUE);
        for ($i=0; $i <count($data); $i++) { 
           fputcsv($file, $data[$i]);
           $data[$i] = NULL; // free up memory
           unset($data[$i]); // try to delete the array key to free memory
        }

        $filename = 'csv_' . date('Ymd') .'_' . date('His').'.csv';

        rename($filePath, "/var/www/bnb_live/application/logs/".$filename);

        echo "\r\nMoved file ".$filePath." ---> /var/www/bnb_live/application/logs/".$filename;
            //$string = ob_get_clean();
            /*header("Cache-Control: private",false);
            header("Content-Type: application/csv");
            header("Content-Disposition: attachment filename=\"$filename.csv\";" );
            header("Content-Transfer-Encoding: binary");*/
           // exit($string); 
    } 
  }
?>